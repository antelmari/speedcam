<!DOCTYPE html>
<html lang="ru">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="Описание страницы">
    <meta name="keywords" content="Ключевые слова страницы">

    <title>Фото штрафа</title>

    <!-- styles -->
    <link rel="stylesheet" href="css/libs.css">
    <link rel="stylesheet" href="css/styles.css">

    <!-- scripts -->
    <script src="js/libs.js" defer></script>
    <script src="js/scripts.js" defer></script>
</head>

    <body>
        <section class="fine-photo">
            <div class="sidepanel">
    <div class="sidepanel-content">
        <div class="sidepanel-content__logo">
            <svg><use xlink:href="imgs/sprite.svg#logo"></use></svg>
        </div>
        <div class="sidepanel-content-steps">
            <div class="sidepanel-content-steps__step sidepanel-content-steps__step--ready sidepanel-content-steps__step--first">
                <div class="sidepanel-content-steps__number title--form-text-1">1</div>
                <div class="sidepanel-content-steps__ready">
                    <svg><use xlink:href="imgs/sprite.svg#ready"></use></svg>
                </div>
                <div class="sidepanel-content-steps__title title--text-1">Цель заявки</div>
            </div>
            <div class="sidepanel-content-steps__step sidepanel-content-steps__step--active">
                <div class="sidepanel-content-steps__number title--form-text-1">2</div>
                <div class="sidepanel-content-steps__ready">
                    <svg><use xlink:href="imgs/sprite.svg#ready"></use></svg>
                </div>
                <div class="sidepanel-content-steps__title title--text-2">Данные о камере</div>
            </div>
            <div class="sidepanel-content-steps__step">
                <div class="sidepanel-content-steps__number title--form-text-1">3</div>
                <div class="sidepanel-content-steps__title title--text-2">Контактная информация</div>
            </div>
        </div>
        <div class="sidepanel-content__link title--additional-text-2">
            <a href="">iboxstore.ru</a>
        </div>
    </div>
</div>

            <div class="fine-photo-wrapper">
                <div class="header-mobile">
    <div class="header-mobile__logo">
        <svg><use xlink:href="imgs/sprite.svg#logo"></use></svg>
    </div>
    <div class="header-mobile__title title--text-1">Данные о камере</div>
    <div class="header-mobile-steps">
        <div class="header-mobile-steps__step header-mobile-steps__step--ready header-mobile-steps__step--first">
            <div class="header-mobile-steps__number title--form-text-1">1</div>
            <div class="header-mobile-steps__ready">
                <svg><use xlink:href="imgs/sprite.svg#ready"></use></svg>
            </div>
        </div>
        <div class="header-mobile-steps__step header-mobile-steps__step--active">
            <div class="header-mobile-steps__number title--form-text-1">2</div>
            <div class="header-mobile-steps__ready">
                <svg><use xlink:href="imgs/sprite.svg#ready"></use></svg>
            </div>
        </div>
        <div class="header-mobile-steps__step">
            <div class="header-mobile-steps__number title--form-text-1">3</div>
            <div class="header-mobile-steps__ready">
                <svg><use xlink:href="imgs/sprite.svg#ready"></use></svg>
            </div>
        </div>
    </div>
</div>

                <div class="fine-photo-tabs">
                    <button class="tab tab--click">Фото штрафа</button>
                    <button class="tab tab--desktop" disabled>Удалите фото, чтобы заполнить вручную</button>
                    <button class="tab tab--mobile" disabled>Удалить фото</button>
                </div>

                <div class="fine-photo-content">
                    <div class="fine-photo-cards">
                        <div class="fine-photo-card">
                            <div class="fine-photo-card__title fine-photo-card__title--first title--form">Прикрепить фото:</div>
                            
                            <div class="fine-photo-card__box fine-photo-card__box--completed">
    <div class="fine-photo-card__plus">
        <svg><use xlink:href="imgs/sprite.svg#plus"></use></svg>
    </div>
    <input type="file" class="fine-photo-card__file">
    <div class="fine-photo-card__close">
        <svg><use xlink:href="imgs/sprite.svg#close--mini"></use></svg>
    </div>
    
        <div class="fine-photo-card__img">
            <img src="imgs/fine-photo/uploaded-photo.jpg" alt="uploaded-photo">
        </div>
    
</div>

                            <div class="fine-photo-card__link title--form-text-underline">
                                <a class="popup" href="#popup-example">Пример фото</a>
                            </div>
                        </div>
                        <div class="fine-photo-card">
                            <div class="fine-photo-card__title title--form">Комментарий:</div>
                            <div class="textarea textarea">
                                <textarea class="fine-photo-card__box comment" placeholder="Ввести текст" maxlength="250"></textarea>
                                <svg class="textarea__icon"><use xlink:href="imgs/sprite.svg#textarea"></use></svg>
                            </div>
                            <div class="counter"><span class="count">0</span>/250</div>
                            <div class="fine-photo-card__link--hide">
                                <input type="file" class="fine-photo-card__file">
                                <div class="fine-photo-card__clip">
                                    <svg><use xlink:href="imgs/sprite.svg#clip"></use></svg>
                                </div>
                                <div class="fine-photo-card__text title--form-text-underline">Прикрепите фото/видео</div>
                            </div>
                            <div class="fine-photo-card-files">
                                <div class="fine-photo-card-files__item">
                                    <img src="imgs/fine-photo/file.jpg" alt="file">
                                    <div class="fine-photo-card-files__close">x</div>
                                </div>
                                <div class="fine-photo-card-files__item">
                                    <img src="imgs/fine-photo/file.jpg" alt="file">
                                    <div class="fine-photo-card-files__close">x</div>
                                </div>
                                <div class="fine-photo-card-files__item--other">
                                    <input type="file">
                                    <div class="fine-photo-card-files__box">
                                        <div class="fine-photo-card-files__plus">
                                            <svg><use xlink:href="imgs/sprite.svg#plus"></use></svg>
                                        </div>
                                    </div>
                                    <div class="fine-photo-card-files__counter">2</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="fine-photo__descr title--additional-text-1">Приложите фото или скриншот штрафа. На нем должны быть хорошо видны&nbsp;<br>данные о скорости, координатах, типе и направлении камеры.</div>
                </div>
                <div class="fine-photo-buttons">
                    <button class="btn btn--back">Назад</button>
                    <button class="btn btn--next">Далее</button>
                </div>
            </div>

        </section>

        <div class="popup">
    <div id="popup-example" class="zoom-anim-dialog mfp-hide popup__item popup-example">
        <div class="popup__close">
          <svg class="popup__close-icon"><use xlink:href="imgs/sprite.svg#close"></use></svg>
        </div>
        <div class="popup__img">
            <img src="imgs/fine-photo/example.jpg" alt="example">
        </div>
    </div>

    <div id="popup-map" class="zoom-anim-dialog mfp-hide popup__item popup-map">
        <div class="popup__close">
            <svg class="popup__close-icon"><use xlink:href="imgs/sprite.svg#close"></use></svg>
        </div>
        <div class="popup-search">
            <div class="popup-search__block"></div>
        </div>
        <div class="popup__map">
            <div id="map" class="map"></div>
        </div>
    </div>

    <div id="popup-photos" class="zoom-anim-dialog mfp-hide popup__item popup-photos">
        <div class="popup__close">
          <svg class="popup__close-icon"><use xlink:href="imgs/sprite.svg#close"></use></svg>
        </div>
        <div class="popup__photos">
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
            <div class="popup__photo">
                <img src="imgs/fine-photo/photo.jpg" alt="photo">
            </div>
        </div>
    </div>
</div>

<script src="https://api-maps.yandex.ru/2.1/?apikey=cab3d95d-df53-4f33-90d5-4bfc71e40bdd&lang=ru_RU"></script>
<script>
    let address = 'Республика Татарстан, Буинский район, Р-241, 111-й километр';
    let coordinates = [54.945834, 48.286889];
    const inputMap = document.querySelector('.input__map');
    ymaps.ready(init);

    function init() {
        const geolocation = ymaps.geolocation;
        geolocation.get({
            provider: 'yandex',
            mapStateAutoApply: true
        }).then(function (res) {
            address = res.geoObjects.get(0).getAddressLine();
            coordinates = res.geoObjects.get(0).geometry.getCoordinates();
            placemark.geometry.setCoordinates(coordinates);
            map.geoObjects.add(placemark);
            map.balloon.open(coordinates,
            `<h3 class="popup__address">Указанный адрес:<br>${address}</h3>
            <button class="popup__btn" onclick="outputOfCoordinates()">Выбрать</button>`,
            {
                closeButton: false
            });
        });
        const map = new ymaps.Map('map', {
            center: coordinates,
            zoom: 14,
            controls: ['zoomControl', 'searchControl', 'geolocationControl']
        });
        const placemark = new ymaps.Placemark(coordinates, {
            preset: 'islands#blueDotIcon'
        });
        map.options.set('yandexMapDisablePoiInteractivity', true);
        placemark.options.set('hasBalloon', false);
        map.geoObjects.add(placemark);
        map.balloon.open(coordinates,
        `<h3 class="popup__address">Указанный адрес:<br>${address}</h3>
        <button class="popup__btn" onclick="outputOfCoordinates()">Выбрать</button>`,
        {
            closeButton: false
        });

        map.events.add('click', function (e) {
            coordinates = e.get('coords');
            ymaps.geocode(coordinates).then(function (res) {
                address = res.geoObjects.get(0).getAddressLine();
                placemark.geometry.setCoordinates(coordinates);
                map.geoObjects.add(placemark);
                map.balloon.open(coordinates,
                `<h3 class="popup__address">Указанный адрес:<br>${address}</h3>
                <button class="popup__btn" onclick="outputOfCoordinates()">Выбрать</button>`,
                {
                    closeButton: false
                });
            });
        });

        const searchControl = map.controls.get('searchControl');
        searchControl.options.set('noPlacemark', 'true');
        searchControl.events.add('submit', function () {
            address = searchControl.getRequestString();
            let myReverseGeocoder = ymaps.geocode(address);
            myReverseGeocoder.then(function (res) {
                coordinates = res.geoObjects.get(0).geometry.getCoordinates();
                placemark.geometry.setCoordinates(coordinates);
                map.geoObjects.add(placemark);
                map.balloon.open(coordinates,
                `<h3 class="popup__address">Указанный адрес:<br>${address}</h3>
                <button class="popup__btn" onclick="outputOfCoordinates()">Выбрать</button>`,
                {
                    closeButton: false
                });
		    });
        });

        const geolocationControl = map.controls.get('geolocationControl');
        geolocationControl.options.set('noPlacemark', 'true');
        geolocationControl.events.add('click', function () {
            geolocation.get({
                provider: 'yandex',
                mapStateAutoApply: true
            }).then(function (res) {
                address = res.geoObjects.get(0).getAddressLine();
                coordinates = res.geoObjects.get(0).geometry.getCoordinates();
                placemark.geometry.setCoordinates(coordinates);
                map.geoObjects.add(placemark);
                map.balloon.open(coordinates,
                `<h3 class="popup__address">Указанный адрес:<br>${address}</h3>
                <button class="popup__btn" onclick="outputOfCoordinates()">Выбрать</button>`,
                {
                    closeButton: false
                });
            });
        });
    }

    function outputOfCoordinates() {
        inputMap.value = `${coordinates[0]}, ${coordinates[1]}`;
        closePopup();
    }
</script>
    </body>
</html>